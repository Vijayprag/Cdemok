<apex:page controller="DHC_SetThresholdController" sidebar="false" cache="false">
    <!-- Start - Include Script & BootStrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" />
    <apex:includeScript value="{!URLFOR($Resource.DHC_DesignResource,'/js/jquery.min.js')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.DHC_RESOURCE,'/DHC_RESOURCE/jquery-ui.css')}"/>
    <apex:includeScript value="{!URLFOR($Resource.DHC_RESOURCE,'/DHC_RESOURCE/jquery-ui.js')}"/>
    <!-- END - Include Script & BootStrap -->
    <!-- Start Script for Accordian --> 
    <script>
        $( function() {
            // $( document ).tooltip();
        } );
        function CallOrganziation(){
            callDailyLimit();
        }
        function switchCustomSetting(){
            
            switchButtonFun();
        }
        
        function callActionMethod(){
           var txtVal1 = document.getElementById("{!$Component.frm.pd1.txt1}").value;
           var txtVal2 = document.getElementById("{!$Component.frm.pd1.txt2}").value;
           var txtVal3 = document.getElementById("{!$Component.frm.pd1.txt3}").value;
           var txtVal4 = document.getElementById("{!$Component.frm.pd1.txt4}").value;
           var txtVal5 = document.getElementById("{!$Component.frm.pd1.txt5}").value;
           /*Below Method is generated by "apex:actionFunction" which will call Apex Method "echoVal" */
            if (txtVal1 == null || txtVal1 == "" ) {
                alert("User Name must be filled out");
                return false;
            }else if(txtVal2 == null || txtVal2 == "" ){
                    alert("Password must be filled out");
                    return false;
                }else if(txtVal3 == null || txtVal3 == "" ){
                    alert("Security Token must be filled out");
                    return false;
                }else if(txtVal4 == null || txtVal4 == "" ){
                    alert("Client ID must be filled out");
                    return false;
                }else if(txtVal5 == null || txtVal5 == "" ){
                    alert("Client Secret must be filled out");
                    return false;
                } else {
                 var atpos = txtVal1.indexOf("@");
                 var dotpos = txtVal1.lastIndexOf(".");
                 if (atpos<1 || dotpos<atpos+2 || dotpos+2>=txtVal1.length) {
                    alert("Not a valid e-mail address");
                    return false;
                 }else{
                     echo(txtVal1,txtVal2,txtVal3,txtVal4,txtVal5);
                 }
            }
        }
    </script>
    <script>
        $( function() {
            $(".containerToggleHeader").click(function(){
                console.log("containerToggleHeader fired...");
                var idOfDetailContainer = $(this).attr("id");
                console.log("idOfDetailContainer : " + idOfDetailContainer);
                $(".limitContainer").hide();
                
                $(".minMaxIcon").each(function(){
                    if($(this).hasClass("fa-minus-square")){
                    console.log('fa-minus-square++++');
                        $(this).removeClass("fa-minus-square");
                        $(this).addClass("fa-plus-square");
                    }
                });
                
                if($("." + idOfDetailContainer).hasClass("activeTab")){
                    $("." + idOfDetailContainer).slideUp(500);
                    $("." + idOfDetailContainer).removeClass("activeTab");
                }
                else{
                    $(".limitContainer").removeClass("activeTab");
                    $("." + idOfDetailContainer).slideDown(300);
                    $("." + idOfDetailContainer).addClass("activeTab");
                    
                    $(this).find(".fa").each(function(){
                        if($(this).hasClass("fa-plus-square")){
                        console.log('fa-plus-square');
                            $(this).removeClass("fa-plus-square");
                            $(this).addClass("fa-minus-square");
                        }
                       
                    }); 
                }
            });

        });
        function whenClicked() {
           window.top.close();
           opener.location.href = "/apex/DHC_SYSTEMLIMITUSAGE";
        }
        
    </script>
    <!-- End Script for Accordian --> 
    <!-- Start - CSS for Form and Buttons -->
    <style>
      .pointer{
        cursor:pointer;
        border:1px solid #ccc;
        padding:5px;
       }
  
       .tableset{
            width: 100%;
            float: left;
        }
        a{
            color:#1797c0;
        }
        
        .tableset thead tr th, .tableset tbody tr td{
            text-align: left;
            padding: 8px 20px 8px 15px;
            border: 1px solid #f2f3f3;      
        }
        
        .tableset thead tr th{
            background-color: #1797c0;
            border: 1px solid #ccc; 
            color: white;
            font-weight: bold;
            text-shadow: 2px 1px black;
      
        }
         .containerToggleHeader:hover{
            box-shadow: 0px 0px 2px 2px #ccc;
        }
        
        .grad2 {
            background: #3498db; /* For browsers that do not support gradients */
            background: -webkit-linear-gradient(#3498db, #13496c); /* For Safari 5.1 to 6.0 */
            background: -o-linear-gradient(#3498db, #13496c); /* For Opera 11.1 to 12.0 */
            background: -moz-linear-gradient(#3498db, #13496c); /* For Firefox 3.6 to 15 */
            background: linear-gradient(#3498db, #13496c); /* Standard syntax */
        }
        
        .grad1 {
          background: #1797c0 ;  /* For browsers that do not support gradients */
          background: -webkit-linear-gradient(left, #1797c0, #1797c0, #1797c0 , #13496c); /* For Safari 5.1 to 6.0 */
          background: -o-linear-gradient(right, #1797c0, #1797c0, #1797c0, #13496c); /* For Opera 11.1 to 12.0 */
          background: -moz-linear-gradient(right, #1797c0, #1797c0, #1797c0, #13496c); /* For Firefox 3.6 to 15 */
          background: linear-gradient(to right, #1797c0, #1797c0,  #1797c0, #13496c); /* Standard syntax */
        }
        /**** tooltop css ***/
        .tooltip1 {
            position: relative;
            display: inline-block;
            //border-bottom: 1px dotted black;
        }
        .tooltip1 .tooltiptext ,.tooltip1 .tooltiptextOnClick{
          visibility: hidden;
          width: 140px;
          background-color: black;
          color: #fff;
          text-align: center;
          border-radius: 6px;
          padding: 5px 0;
          position: absolute;
          bottom: 100%;
          z-index: 1500 !important;
          left: 50%;
          margin-left: -43px;
          font-size: 13px;
        }
        .tooltip1 .tooltiptext::after, .tooltip1 .tooltiptextOnClick::after{
          content: "";
          position: absolute;
          top: 50%;
          left: 100%;
          margin-left: -5px;
          border-width: 5px;
          border-style: solid;
          border-color: black transparent transparent transparent;
        }
        .tooltip1:hover .tooltiptext {
            visibility: visible;
        }
        /**** tooltop css ***/
    </style>
    <!-- END - CSS for Form and Buttons -->
    <apex:form id="frm">
    <apex:pageMessages />

        <apex:actionFunction name="callDailyLimit" action="{!updateThresholdData}" />
        <apex:actionFunction name="switchButtonFun" action="{!switchButton}"  />
        <apex:actionFunction name="echo" action="{!encryptedPassword}" />
        <div style="width: 100%; float: left;">
            <div style="width: 100%; float: left;">
                <div style="width: 100%; float: left;">
                    <div style="width: 100%; float: left;padding-bottom:10px;">
                      <div style="float:left;" >
                                <a href="#" onclick="whenClicked()"><i class="fa fa-arrow-circle-left" aria-hidden="true" style="padding-right:10px;padding-top: 4px; float: left; font-size: 46px; color: #1797c0;"></i>
                                <div style="float: left;padding-top: 15px;font-size: 17px;font-weight: bolder;color: #1797c0;    padding-right: 10px;">{!$Label.DHC_Back}
                                </div>
                                </a>
                           </div>
                        <div style="float:left;">
                            <a href="#" onclick="CallOrganziation();" style="float: left;">
                                <i class="fa fa-floppy-o" aria-hidden="true" style="float: left; font-size: 42px; color: #1797c0;">
                                </i>
                                <div style="float: left; padding-left:8px; padding-top: 15px;font-size: 17px;font-weight: bolder;color: #1797c0;    padding-right: 10px;"> {!$Label.DHC_Save}
                                </div>
                            </a>
                        </div>
                       <div style="float:left;" >
                            <a href="#" onclick="switchCustomSetting();" style="float: left;">
                                <i class="fa fa-power-off" aria-hidden="true" style="float:left; font-size: 42px; color: #1797c0;">
                                </i>
                                <div style="float:left;padding-top: 15px;padding-left:8px;font-size: 17px;font-weight: bolder;color: #1797c0;    padding-right: 10px;">{!$Label.DHC_Switch}
                                </div>
                            </a>
                        </div>       
                     </div>
                </div>
                <div id="RunTimeLimitTypeContainer" class="containerToggleHeader grad1" style="width: 100%; float: left; padding: 8px 0px 8px 20px;  box-sizing: border-box; cursor: pointer; color: white; font-size:16px;">
                    {!$Label.DHC_RunTime_Setup}
                    <i class="fa fa-minus-square minMaxIcon" aria-hidden="true" style="float: right; height:5px; width: 20px;"></i>
                </div>
                <div style="width: 100%; float: left; box-shadow: 0px 0px 2px 2px #ccc;">
                     <div class="RunTimeLimitTypeContainer limitContainer activeTab" style="margin-left: 10px;margin-right: 10px; width:97%;padding-top: 5px;">
                        <div style="float:left; width:100%; margin-bottom: 10px;">
                            <apex:outputPanel >
                                <table class="tableset" cellspacing="0px" style="border-collapse;">
                                    <thead>
                                        <tr>
                                            <th style="border-top-left-radius: 5px; border-bottom-left-radius: 5px; text-align: left;">
                                            {!$Label.DHC_Switch}
                                            </th>
                                            <th style="">
                                            {!$Label.DHC_Limit_Type} 
                                            </th>
                                            <th style="text-align: center;">
                                            {!$Label.DHC_Limit_Category}
                                            </th>
                                            <th style="text-align: right;">
                                            {!$Label.DHC_Max_Limit}
                                            </th>
                                            <th style="text-align: right;">
                                            {!$Label.DHC_Hard_Threshold}
                                            </th> 
                                             <th style="text-align: right;">
                                            {!$Label.DHC_Soft_Threshold}
                                            </th>
                                            <th style="text-align: left;">
                                            {!$Label.DHC_Async_Max_Limit}
                                            </th>
                                            <th style="text-align: left;">
                                            {!$Label.DHC_Async_Hard_Limit}
                                            </th>
                                            <th style="text-align: left;">
                                            {!$Label.DHC_Async_Soft_Limit} 
                                            </th>
                                            <th style="text-align: left;">
                                            {!$Label.DHC_Hard_Email}
                                            </th>
                                            <th style="text-align: left;">
                                            {!$Label.DHC_Soft_Email}
                                            </th>
                                            <th style="text-align: left;">
                                             Last Modified By
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>             
                                        <apex:repeat var="cases" value="{!runTimeCustomSettingList}">
                                        <tr> 
                                            <td class="tdset" style="text-align: left;width:50px;">
                                             <apex:outputField value="{!cases.Switch__c}" style="width:50px;"/>
                                            </td>
                                            <td class="tdset" style="text-align: left;">
                                                {!cases.Display_Name__c}
                                            </td>
                                            <td class="tdset" style="text-align: center;" >
                                                {!cases.Limit_Type__c}
                                            </td>
                                            <td class="tdset" style="text-align: right;">
                                                <apex:outputText value="{!FLOOR(cases.Max_Limit__c)}" />
                                            </td>
                                            <td class="tdset" style="text-align: right;">
                                                <apex:inputField value="{!cases.Hard_Threshold__c}"  style="width:70px;"/>
                                            </td> 
                                            <td class="tdset" style="text-align: right;">
                                                <apex:inputField value="{!cases.Soft_Threshold__c}"  style="width:70px;" />
                                            </td>
                                            <td class="tdset" style="text-align: right;">
                                                  <apex:outputText value="{0,number,}"  >
                                                        <apex:param value="{!cases.Async_Max_Limit__c}" />
                                                    </apex:outputText>
                                            </td>
                                            <td class="tdset" style="text-align: left;">
                                                <apex:inputField value="{!cases.Async_Hard_Threshold__c}" style="width:70px;" />
                                            </td>
                                            <td class="tdset" style="text-align: left;">
                                                <apex:inputField value="{!cases.Async_Soft_Threshold__c}" style="width:70px;" />
                                            </td>
                                            <td class="tdset" style="text-align: center;width:50px;">
                                                <apex:inputField value="{!cases.Send_Hard_Threshold_Notification__c}" style="width:50px;"/>
                                            </td>
                                            <td class="tdset" style="text-align: center;width:50px;">
                                            <apex:inputField value="{!cases.Send_Soft_Threshold_Notification__c}" style="width:50px;"/>
                                             </td>
                                            <td class="tdset" style="text-align: left;">
                                                {!cases.LastModifiedBY.Name}<br/>
                                                <apex:outputField value="{!cases.LastModifiedDate}" />  
                                            </td>
                                        </tr>
                                       </apex:repeat>
                                   </tbody>            
                                </table>
                            </apex:outputPanel>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div style="width: 100%; float: left;">
            <div style="width: 100%; float: left;">     
                <div id="RunTimeLimitSobjectContainer" class="containerToggleHeader grad1" style="width: 100%; float: left; padding: 8px 0px 8px 20px;  box-sizing: border-box; cursor: pointer; margin-top: 10px; color: white;font-size:16px;">
                    {!$Label.DHC_Organization_setup}
                    <i class="fa fa-plus-square minMaxIcon" aria-hidden="true" style="float: right; height:5px; width: 20px;"></i>
                </div>
                <div style="width: 100%; float: left; box-shadow: 0px 0px 2px 2px #ccc;">
                    <div class="RunTimeLimitSobjectContainer limitContainer" style="margin: 0 auto; width:97%;padding-top: 5px;display: none;">
                        <div style="float:left; width:100%; margin-bottom: 10px;">
                            <apex:outputPanel >
                                <table class="tableset" cellspacing="0px" style="border-collapse;">
                                    <thead>
                                        <tr>
                                            <th style="border-top-left-radius: 5px; border-bottom-left-radius: 5px; text-align: left;">
                                            {!$Label.DHC_Switch}
                                            </th>
                                            <th style="">
                                            {!$Label.DHC_Limit_Type}
                                            </th>
                                            <th style="text-align: left;">
                                            {!$Label.DHC_Limit_Category} 
                                            </th>
                                            <th style="text-align: right;">
                                            {!$Label.DHC_Max_Limit}
                                            </th>
                                            <th style="text-align: right;">
                                            {!$Label.DHC_Hard_Threshold}
                                            </th> 
                                             <th style="text-align: right;">
                                            {!$Label.DHC_Soft_Threshold}
                                            </th>
                                            <th style="text-align: center;">
                                            {!$Label.DHC_Hard_Notification}
                                            </th>
                                            <th style="text-align: center;">
                                            {!$Label.DHC_Soft_Notification}
                                            </th>
                                            <th style="text-align: left;">
                                             Last Modified By
                                            </th>
                                         </tr>
                                    </thead>
                                    <tbody>             
                                        <apex:repeat var="cases" value="{!organizationCustomSettingList}">
                                            <tr>
                                                <td class="tdset" style="text-align: left;">
                                                    <apex:outputField value="{!cases.Switch__c}" style="width:50px;" />
                                                </td>
                                                <td class="tdset" style="text-align: left;">
                                                    {!cases.Display_Name__c}
                                                </td>
                                                <td class="tdset" style="text-align: left;" >
                                                    {!cases.Limit_Type__c}
                                                </td>
                                                <td class="tdset" style="text-align: right;">
                                                   <apex:outputText value="{!FLOOR(cases.Max_Limit__c)}" />
                                                </td>
                                                <td class="tdset" style="text-align: right;">
                                                    <apex:inputField value="{!cases.Hard_Threshold__c}" style="width:70px;"/>
                                                </td> 
                                                <td class="tdset" style="text-align: right;">
                                                    <apex:inputField value="{!cases.Soft_Threshold__c}" style="width:70px;"/>
                                                </td>
                                                <td class="tdset" style="text-align: center;">
                                                    <apex:inputField value="{!cases.Send_Hard_Threshold_Notification__c}" style="width:50px;" />
                                                </td>
                                                <td class="tdset" style="text-align: center;">
                                                    <apex:inputField value="{!cases.Send_Soft_Threshold_Notification__c}" style="width:50px;" />
                                                </td>
                                                <td class="tdset" style="text-align: left;">
                                                {!cases.LastModifiedBY.Name}<br/>
                                                <apex:outputField value="{!cases.LastModifiedDate}" />  
                                                </td>
                                            </tr>
                                       </apex:repeat>
                                   </tbody>            
                                </table>
                            </apex:outputPanel>
                        </div>
                    </div>
                </div>
            </div>
        </div> 
        <div style="width: 100%; float: left;">
            <div style="width: 100%; float: left;">     
                <div id="RunTimeLimitContainer" class="containerToggleHeader grad1" style="width: 100%; float: left; padding: 8px 0px 8px 20px;  box-sizing: border-box; cursor: pointer; margin-top: 10px; color: white;font-size:16px;">
                    {!$Label.DHC_Logo_Setup}
                    <i class="fa fa-plus-square minMaxIcon" aria-hidden="true" style="float: right; height:5px; width: 20px;"></i>
                </div>
                <div style="width: 100%; float: left; box-shadow: 0px 0px 2px 2px #ccc;">
                    <div class="RunTimeLimitContainer limitContainer" style="margin: 0 auto; width:97%;padding-top: 5px;display: none;">
                        <div style="float:left; width:100%; margin-bottom: 10px;">
                            <apex:outputPanel >
                                <div>
                                    <center>
                                       <apex:image url="/servlet/servlet.FileDownload?file={!docImage[0].id}"/>
                                    </center>
                                </div>
                                <div>
                                    <center>
                                        <apex:inputFile value="{!docImage[0].body}" />
                                    </center>
                                </div>
                            </apex:outputPanel>
                        </div>
                    </div>
                </div>
            </div>
        </div> 
        <!-- Public Group Start-->
        <div style="width: 100%; float: left;">
            <div style="width: 100%; float: left;">     
                <div id="publicGroup" class="containerToggleHeader grad1" style="width: 100%; float: left; padding: 8px 0px 8px 20px;  box-sizing: border-box; cursor: pointer; margin-top: 10px; color: white;font-size:16px;">
                    {!$Label.DHC_Public_Group_Configuration}
                    <i class="fa fa-plus-square minMaxIcon" aria-hidden="true" style="float: right; height:5px; width: 20px;"></i>
                </div>
                <div style="width: 100%; float: left; box-shadow: 0px 0px 2px 2px #ccc;">
                    <div class="publicGroup limitContainer" style="margin: 0 auto; width:97%;padding-top: 5px;display: none;">
                        <div style="float:left; width:100%; margin-bottom: 10px;">
                            <apex:outputPanel >
                                <div>
                                <Span style="font-size:17px;">{!$Label.DHC_Public_Group_Description}</Span><br/><br/>
                                    <apex:outputLink style="font-size:17px;" target="_blank" value="{!$Label.DHC_Hard_Threshold_Group}"><li>{!$Label.DHC_Public_Group_Sub1_Description}</li>
                                    </apex:outputLink><br/>
                                    <apex:outputLink style="font-size:17px;" target="_blank" value="{!$Label.DHC_Soft_Threshold_Group}"><li>{!$Label.DHC_Public_Group_Sub2_Description}</li></apex:outputLink>
                                </div>
                            </apex:outputPanel>
                        </div>
                    </div>
                </div>
            </div>
        </div> 
        <!-- Public Group End -->
        <apex:outputPanel rendered="{!activeProfile}" >
         <div style="width: 100%; float: left;">
            <div style="width: 100%; float: left;">     
                <div id="batchID" class="containerToggleHeader grad1" style="width: 100%; float: left; padding: 8px 0px 8px 20px;  box-sizing: border-box; cursor: pointer; margin-top: 10px; color: white;font-size:16px;">
                    {!$Label.DHC_USERSETUP}
                    <i class="fa fa-plus-square minMaxIcon" aria-hidden="true" style="float: right; height:5px; width: 20px;"></i>
                </div>
                 <div style="width: 100%; float: left; box-shadow: 0px 0px 2px 2px #ccc;">
                    <div class="batchID limitContainer" style="margin: 0 auto; width:97%;padding-top: 5px;display: none;">
                        <div style="float:left; width:100%; margin-bottom: 10px;">
                            <apex:outputPanel >
                                <div>
                                    <apex:pageblock id="pd1" >
                                        <table>
                                            <tr>
                                                <td>
                                                    <apex:outputLabel value="{!$Label.DHC_USERNAME}" for="txt1"/>
                                                </td>
                                                <td>
                                                    <apex:inputText id="txt1" value="{!enteredText1}" />
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <apex:outputLabel value="{!$Label.DHC_PASSWORDSTR}" for="txt2"/>
                                                </td>
                                                <td>
                                                    <apex:inputSecret id="txt2" value="{!enteredText2}"/>
                                                </td>
                                             </tr>
                                            <tr>
                                                <td>
                                                    <apex:outputLabel value="{!$Label.DHC_TOKENSTR}" for="txt3"/>
                                                </td>
                                                <td>
                                                    <apex:inputSecret id="txt3" value="{!enteredText3}"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <apex:outputLabel value="{!$Label.DHC_CLIENTIDSTR}" for="txt4"/>
                                                </td>
                                                <td>
                                                    <apex:inputSecret id="txt4" value="{!enteredText4}"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <apex:outputLabel value="{!$Label.DHC_CLIENTSTR}" for="txt5"/>
                                                </td>
                                                <td>
                                                    <apex:inputSecret id="txt5" value="{!enteredText5}"/>
                                                </td>
                                            </tr>
                                            <tr></tr><tr></tr>
                                            <tr>
                                                <td colspan="3" style="padding-left: 97px;">
                                                    <span class="pointer" onclick="callActionMethod()"> {!$Label.DHC_SUBMIT} </span>
                                                </td>
                                            </tr>
                                        </table>
                                    </apex:pageblock>
                                </div>
                            </apex:outputPanel>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </apex:outputPanel>
    </apex:form>
    </apex:page>